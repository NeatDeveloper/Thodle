# Thodle Database Schema
> Generated by [`prisma-markdown`](https://github.com/samchon/prisma-markdown)

- [Amplua](#amplua)
- [University](#university)
- [User](#user)
- [default](#default)

## Amplua
```mermaid
erDiagram
"Amplua" {
  String id PK
  AmpluaRole role
  DateTime updated_at
  DateTime created_at
}
"Curators" {
  String id PK
}
"GroupHeads" {
  String id PK
  String group FK "nullable"
  GroupHeadRank role
}
"Lectors" {
  String id PK
  String last_name
  String first_name
  String surname
  String initials
  Int faculity FK "nullable"
  DateTime created_at
  DateTime updated_at
}
"LectorRanks" {
  Int id PK
  String name UK
  String short UK
}
"Students" {
  String id PK
  String student_id UK
  String group FK "nullable"
  SubGroupOrder subGroup
}
"Tutors" {
  String id PK
}
"_LectorToLectorRank" {
  String A FK
  String B FK
}
"Curators" |o--|| "Amplua" : Amplua
"GroupHeads" |o--|| "Amplua" : Amplua
"Lectors" |o--|| "Amplua" : Amplua
"Students" |o--|| "Amplua" : Amplua
"Tutors" |o--|| "Amplua" : Amplua
"_LectorToLectorRank" }o--|| "Lectors" : Lector
"_LectorToLectorRank" }o--|| "LectorRanks" : LectorRank
```

### `Amplua`
-------------------------------------------------------
Схема "Амплуа"
-------------------------------------------------------

Модель **Амплуа**

Является точкой входа пользователя в качестве сущности в университете.
Она ссылается на другие модели, но так же, хранит в себе роли пользователя в рамках учреждения

**Properties**
  - `id`: Уникальный идентификатор пользователя
  - `role`
    > Роли пользователя в рамках учреждения
    > 
    > Варианты | Значения
    > -------|--------
    > **UNDEFINED** | Неизвестен. Установлен по умолчанию, поскольку есть вероятность, что человек какое то время будет привязан к группе
    > **STUDENT** | Студент
    > **CURATOR** | Куратор
    > **GROUP_HEAD** | Староста
    > **LECTOR** | Преподаватель
    > **TUTOR** | Тьютор(высока вероятность, что по итогу не реализуем)
  - `updated_at`: Дата обновления сущности в нашей системе
  - `created_at`: Дата создания пользователя в нашей системе

### `Curators`
Модель **Староста**

Профиль старосты

**Properties**
  - `id`: Уникальный идентификатор пользователя(в данном случае, для связи с моделью *Амплуа*)

### `GroupHeads`
Модель **Староста**

Профиль старосты

**Properties**
  - `id`: Уникальный идентификатора пользователя(в данном случае, для связи с моделью *Амплуа*)
  - `group`: Ссылка на группу
  - `role`: Уровень старосты(староста, зам старосты)

### `Lectors`
Модель **Преподаватель**

Профиль преподавателя

**Properties**
  - `id`: Уникальный идентификатора пользователя(в данном случае, для связи с моделью *Амплуа*)
  - `last_name`: Фамилия
  - `first_name`: Имя
  - `surname`: Отчество
  - `initials`: Инициалы
  - `faculity`: Ссылка на факультет преподавателя
  - `created_at`: 
  - `updated_at`: 

### `LectorRanks`
Модель **Ранги Преподавателей**

Предназначен для хранения рангов преподавателей.
Пример: `Доцент (доц.)`, `Профессор (проф.)` и тд

**Properties**
  - `id`: Уникальный идентификатор
  - `name`: Название
  - `short`: Короткий вариант названия

### `Students`
Модель **Студент**

Профиль студента

**Properties**
  - `id`: Уникальный идентификатора пользователя(в данном случае, для связи с моделью *Амплуа*)
  - `student_id`: Уникальный идентификатор студента
  - `group`: Ссылка на группу, в которой находится пользователь
  - `subGroup`: 

### `Tutors`
Модель **Тьютор**

Профиль тьютора

**Properties**
  - `id`: Уникальный идентификатор пользователя(в данном случае, для связи с моделью *Амплуа*)

### `_LectorToLectorRank`
Pair relationship table between [Lectors](#Lectors) and [LectorRanks](#LectorRanks)

**Properties**
  - `A`: 
  - `B`: 


## University
```mermaid
erDiagram
"Auditoriums" {
  Int id PK
  Int building FK
  String number
}
"Buildings" {
  Int id PK
  String name
  String short_name
  String non_verbal_name "nullable"
  String address
  Int university FK
}
"Disciplines" {
  Int id PK
  String name
  String short_name "nullable"
  Int faculity FK "nullable"
  DateTime updated_at
  DateTime created_at
}
"Facilities" {
  Int id PK
  Int university FK
  String name
  String short_name
  DateTime updated_at
  DateTime created_at
}
"Groups" {
  String id PK
  String name UK
  String short_name UK
  String curator FK "nullable"
  Int faculity FK
  String tutor FK "nullable"
  Int year
  DateTime updated_at
  DateTime created_at
}
"Universities" {
  Int id PK
  String name UK
  String short_name UK
  String city
  DateTime updated_at
  DateTime created_at
}
"Weeks" {
  Int id PK
  String title
  WeekOrder order
  Int university FK "nullable"
}
"Auditoriums" }o--|| "Buildings" : Building
"Buildings" }o--|| "Universities" : University
"Disciplines" }o--o| "Facilities" : Faculity
"Facilities" }o--|| "Universities" : University
"Groups" }o--|| "Facilities" : Faculity
"Weeks" }|--o| "Universities" : University
```

### `Auditoriums`
Модель **Аудитории**

Модель, где хранятся данные об аудитории, находящийся в каком то строении

**Properties**
  - `id`: Уникальный идентификатор аудитории в базе данных
  - `building`: Уникальный идентификатор корпуса
  - `number`: Номер аудитории в строковом формате(302, 302a)

### `Buildings`
Модель **Корпуса**

Модель является частью университета, представляющую с собой объект, хранящий данные об отдельных строениях
в которых есть аудитории, в которых могут проходить занятия.

На самом деле, эта модель может быть обширнее, например: стадион или спортзал.

**Properties**
  - `id`: Уникальный идентификатор здания
  - `name`: Название корпуса
  - `short_name`: Короткое название корпуса
  - `non_verbal_name`: Внегласное  название корпуса
  - `address`: Адрес(улица) на котором находится корпус
  - `university`: // Уникальный идентификатор университета, к которому корпус привязан

### `Disciplines`
Модель **Дисциплина**

Модель собирающая в себя данные о дисциплине.

**Properties**
  - `id`: Уникальный идентификатор дисциплины в базе данных
  - `name`: Название дисциплины
  - `short_name`: Короткий формат названия
  - `faculity`: Уникальный идентификатор факультета
  - `updated_at`: Дата обновления дисциплины в нашей системе
  - `created_at`: Дата добавления дисциплины в нашу систему

### `Facilities`
Модель **Факультет**

Модель, описывающая факультет

**Properties**
  - `id`: Уникальный идентификатор университета в базе данных
  - `university`: Уникальный идентификатор университета
  - `name`: 
  - `short_name`: 
  - `updated_at`: Дата обновления пользователя в нашей системе
  - `created_at`: Дата создания пользователя в нашей системе

### `Groups`
Модель **Группа**

Модель, описывающая группу

**Properties**
  - `id`: Уникальный идентификатор группы в университете
  - `name`: Название группы
  - `short_name`: Название группы, короткий вариант
  - `curator`: Ссылка на куратора
  - `faculity`: Ссылка на факультет
  - `tutor`: Ссылка на тьютора
  - `year`: Год создания группы
  - `updated_at`: Дата обновления группы в нашей системе
  - `created_at`: Дата создания группы в нашей системе

### `Universities`
-------------------------------------------------------
Схема "Университет"
-------------------------------------------------------

Модель **Университет**

Модель университета является основной моделью ВУЗов в нашей системе, от неё исходят все остальные модели.

**Properties**
  - `id`: Уникальный идентификатор университета в системе
  - `name`: Название университета
  - `short_name`: Сокращённое название университета
  - `city`: Город, где находится университет
  - `updated_at`: Дата обновления университета в нашей системе
  - `created_at`: Дата создания университета в нашей системе

### `Weeks`
Модель **Неделя**

Описание названий недель университета. В данном случае, это поможет правильно структурировать расписания
и реализовывать поддержку именования недель в конкретном университете.
Например: "Первая и Вторая", "Красная и Чёрная"

**Properties**
  - `id`: ID недели в университете
  - `title`: Название недели в конкретном университете
  - `order`: Порядок недели
  - `university`: Идентификатор университета


## User
```mermaid
erDiagram
"Devices" {
  String user FK
  String ip "nullable"
  String device
  String os "nullable"
}
"Options" {
  String id PK
  Boolean is_blocked
  Boolean he_saw_welcome_screen
}
"Profiles" {
  String id PK
  String avatar "nullable"
  BigInt tg_id UK
  String last_name "nullable"
  String first_name "nullable"
  String username UK "nullable"
  String lang
  Boolean is_premium
  DateTime updated_at
  DateTime created_at
}
"Settings" {
  String id PK
  DateTime updated_at
  DateTime created_at
}
"MiniappSettings" {
  String id PK
  Boolean fullscreen
  ToastPosition toast_position
  Boolean rounded
  Boolean rounded_settings
  ThemePreset preset
  MiniappTheme theme
  MiniappSchema schema
}
"MailingSettings" {
  String id PK
  Boolean isPossible
}
"ScheduleSettings" {
  String id PK
  Boolean short_lesson_name
}
"Users" {
  String id PK
  UserRole role
  DateTime updated_at
  DateTime created_at
}
"Devices" }o--|| "Users" : User
"Options" |o--|| "Users" : User
"Profiles" |o--|| "Users" : User
"Settings" |o--|| "Users" : User
"MiniappSettings" |o--|| "Settings" : Settings
"MailingSettings" |o--|| "Settings" : Settings
"ScheduleSettings" |o--|| "Settings" : Settings
```

### `Devices`
Модель **Устройство**

Предназначен для реализации минимальной статистики пользователей сервиса

**Properties**
  - `user`: Уникальный идентификатор пользователя
  - `ip`: IP адресс, если удалось получить
  - `device`: Название устройства, если удалось получить
  - `os`: Название операционной системы, если удалось получить

### `Options`
Модель **Опции**

Хранит в себе поля с дополнительными ключами для работы сервиса

**Properties**
  - `id`: Уникальный идентификатор пользователя
  - `is_blocked`: Предназначен для показа статуса блокировки пользователя в системе
  - `he_saw_welcome_screen`: Увидел ли пользователь приветственное окно в мини приложении

### `Profiles`
Модель **Профиль**

Хранит в себе данные телеграм аккаунта пользователя

**Properties**
  - `id`: Уникальный идентификатор пользователя в системе
  - `avatar`: Аватар пользователя
  - `tg_id`: Уникальный идентификатор пользователя в телеграм
  - `last_name`: Фамилия пользователя в телеграм
  - `first_name`: Имя в телеграм
  - `username`: Имя пользователя в телеграм
  - `lang`: Выбраный им язык
  - `is_premium`: Является ли пользователь премиум подписчиком в телеграм
  - `updated_at`: Дата обновления профиля пользователя в нашей системе
  - `created_at`: Дата создания профиля пользователя в нашей системе

### `Settings`
Модель **Настройки**

Хранит в себе параметры работы или показа приложения **Thodle**

**Properties**
  - `id`: Уникальный идентификатор пользователя
  - `updated_at`: Дата обновления настроек пользователя в нашей системе
  - `created_at`: Дата создания настроек пользователя в нашей системе

### `MiniappSettings`
Модель **Настройки Мини Приложения**

Хранит в себе параметры работы или показа мини приложения телеграм

**Properties**
  - `id`: Уникальный идентификатор пользователя(в данном случае, для связи с моделью *Настройки*)
  - `fullscreen`: Полноэкранный режим
  - `toast_position`: Позиционирование тостов(мини уведомлений)
  - `rounded`: Скругления интерфейса
  - `rounded_settings`: Скругления интерфейса настроек
  - `preset`
    > Параметры внешнего вида приложений
    > 
    > Варианты | Значения
    > -------|--------
    > **Thodle** | Предустановленные параметры внешнего вида
    > **Custom** | Пользовательские параметры внешнего вида
  - `theme`
    > Тема приложения
    > 
    > Варианты | Значения
    > -------|---------
    > **Device** | Тема устройства
    > **Thodle** | Наша кастомная тема *Thodle*
    > **Mint** | Тема *Мята*
  - `schema`
    > Цветовая схема
    > 
    > Варианты | Значения
    > -------|---------
    > **Auto** | Схема устройства
    > **Dark** | Тёмная
    > **Light** | Светлая

### `MailingSettings`
Модель **Параметры Рассылки**

Хранит в себе параметры рассылки

**Properties**
  - `id`: Уникальный идентификатор пользователя(в данном случае, для связи с моделью *Настройки*)
  - `isPossible`: Разрешена ли рассылка

### `ScheduleSettings`
Модель **Расписание**

Хранит в себе параметры работы или показа расписаний как в мини приложении, так и в сообщениях от бота

**Properties**
  - `id`: Уникальный идентификатор пользователя(в данном случае, для связи с моделью *Настройки*)
  - `short_lesson_name`: Показывать короткие названия пар?

### `Users`
-------------------------------------------------------
Схема "Users"
-------------------------------------------------------

Модель **Пользователь**

Является точкой входа пользователя в системе **Thodle**.
Не хранит важные и значимые данные, а только ссылки на другие модели, предназначенные для этого.
Есть только поле `role`, которое хранит роль пользователя в системе.

**Properties**
  - `id`: Уникальный идентификатор пользователя
  - `role`
    > Роль пользователя в системе
    > 
    > Ключ | Значение
    > -------|--------
    > **R_0**    | **Regular**   : Обычный пользователь. Не имеет доступ ни к чему, кроме самого сервиса DAPP и бота.
    > **R_1**    | **Increase**  : Пользователь
    > **R_2**    | **Supervisor**:
    > **R_3**    | **Admin**     :
  - `updated_at`: Дата обновления пользователя в нашей системе
  - `created_at`: Дата создания пользователя в нашей системе


## default
```mermaid
erDiagram
"Lessons" {
  Int id PK
  String group FK
  Int discipline FK
  Int auditorium FK
  String lector FK
  SubGroupOrder from_sub_group "nullable"
}
"StudyTimes" {
  Int id PK
  Int start_time
  Int duration_lesson
  Int break_time
  Int break_lesson_time "nullable"
  Int start_big_break_time
  Int duration_big_break_time
}
```

### `Lessons`

**Properties**
  - `id`: 
  - `group`: 
  - `discipline`: 
  - `auditorium`: 
  - `lector`: 
  - `from_sub_group`: 

### `StudyTimes`

**Properties**
  - `id`: 
  - `start_time`: 
  - `duration_lesson`: 
  - `break_time`: 
  - `break_lesson_time`: 
  - `start_big_break_time`: 
  - `duration_big_break_time`: 